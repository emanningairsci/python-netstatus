"""
Handles logging flag information to MongoDB.
"""

from pymongo import MongoClient
from pymongo import ASCENDING
import datetime
import config
import time


client = MongoClient()
db = client.netstatusDB
collection = db.flags
collection.ensure_index([("timestamp", ASCENDING)])


def setFlag(hostname, flag):
    db.flags.update({"hostname": hostname}, {'$set': {"flag": flag}}, True)
    print "flag created for %s" %hostname
    return False


def getFlag(hostname):
    if db.flags.find({"hostname": hostname, "flag": 1).count() == 0:
        flag = 0
    else:
        flag = 1
    return flag
